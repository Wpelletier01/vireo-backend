# vireo-backend


## Description
This project is a robust back-end server service
designed to handle API requests for a video sharing and social media website.
The service is implemented in Python using the popular micro web framework call Flask.

The primary responsibilities of the server service include:
- Ensuring that the incoming requests are correctly formed and adhering to the required specifications.
- Executing queries on the MariaDB database to retrieve relevant information about users or videos.
- Facilitating the seamless transmission of video or image files stored locally.
- Implementing secure processing of JWT tokens for authentication and authorization purposes.
- Plus, various other essential tasks to ensure smooth operation.



### How it works
TODO: Finish it

The database stores metadata on the user and videos.
The video file and his thumbnails, and user profile picture 
is stored locally on the machine that runs the service in a common folder.
The server query info on the database and send the information back to the requester.
When the requester wants a file like a video, he goes grab it in the common directory. 
The thumbnails and the video file are named with their hash path that has been generated when uploaded.
For now, the user can't choose a thumbnails.
The server selected a random frame in the video and created an image
with it that served has thumbnails.


### Motivation
The motivation behind undertaking this project was to gain a deeper understanding of the functionality,
purpose, and significance of back-end servers.
By developing a server from scratch, I aimed to explore the intricacies involved in building a robust back-end system.
Flask was chosen as the framework of choice due to its minimalist approach,
allowing me to focus on essential aspects and gain comprehensive knowledge in server development.

## Installation

TODO

## Api Call 

All the api call return a body with the key "response" Either empty or with data.
expect for sending file like a video or an image. 

the universal return value when request info on channels or videos is formed like this:

    "type": "either video or channel", 
    "channel": "channel username",
    "title": "the title",
    "thumbnail": "the hashed path of a video",
    "nb_count": "count of videos a channel have",
    "description": "description of a video",
    "upload": "the date of upload"
note that some keys can return empty depending on the type of request e.g., when ask for info on a video, the key 
nb_count since it is reserved for request on channel info.
I might add more in the future

### POST <u>/sign_in </u>
parameter: 
- username: string
- password: string

return:
- Jwt token generated with the parameter passed as payload that expires in 3 hours

### POST <u>/sign_up</u>
parameter:
- fname (first name) : string
- mname (Middle name, it can be empty) : string
- lname (last name) : string
- username : string
- email : string 
- password : string 
- day  (birth) : int
- month (birth) : int 
- year (birth): int 

return:
- 200 if creation succeeds

### POST <u>/upload</u>
*require token

upload info on a video to the database

parameter:
- title
- description
return:
- a hash path of the video

### POST <u>/upload/v/</u>*hashpath*
upload a video with a hashed path as id from the url

parameter:
- hashed path in the url
- a raw data video

return:
- 200 if succeed

_*Note that it has been only tested for mp4 format file for now_

### GET <u>/video/d/</u>*hashpath*
retrieve info of a specific video

parameter:
- the hash path in the url

return:
- A universal return body
   


## Database 

The database is created with Mariadb. For the moment, it contains 3 tables:

### Channels table
it stores basic login information.

| ChannelID   | Username    | Password    |
|-------------|-------------|-------------|
| Primary Key | Varchar(25) | Varchar(60) |

- the password is stored has a hashed password with the function bcrypt.

### ChannelDetails
it stores relevant user information

| ChannelID | Fname | Mname | Lname | Email      | Birth |
| ----------|-------|-------|-------|------------|-------|
| ForeignKey | varchar(25) | varchar(25) | varchar(25) | PrimaryKey | date |

- The primary key is email because we want them to be unique

### Videos
it stores information about a video uploaded by a user

| VideoID | PathHash | ChannelID | Title   | Description | Upload   | Like  | Dislike |
|---------|----------|-----------|---------|-------------|----------|-------|---------|
| Primary Key | varchar(7) | Foreign Key | varchar(255) | mediumtext | int(12) | int(12) |

- PathHash is a random string generated by the server to help identified a video (like Youtube).
-  ChannelId identify his uploader





## TODO